<!DOCTYPE html>

<html>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="style1.css">
    <link rel="stylesheet" href="fonts/icomoon/style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">



<!-- Navbar-->
<header class="header">
    <nav class="navbar navbar-expand-lg navbar-light py-3">
        <div class="container">
            <!-- Navbar Brand -->
            <a href="#" class="navbar-brand">
                <img src="https://bootstrapious.com/i/snippets/sn-registeration/logo.svg" alt="logo" width="150">
            </a>
        </div>
    </nav>
</header>

<body onload="onLoadInit()">
<div class="container">
    <div class="row py-5 mt-4 align-items-center">
        <!-- For Demo Purpose -->
        <div class="col-md-5 pr-lg-5 mb-5 mb-md-0">
            <img src="https://i.pinimg.com/originals/d2/83/18/d283184ff0cb3d03871219f9cbd41549.gif" alt="" class="img-fluid mb-3 d-none d-md-block">
            <h1>Login</h1>
            </div>

        <!-- Registeration Form -->
        <div class="col-md-7 col-lg-6 ml-auto">
            <form action="#">
                <div class="row">
                    <!-- Email Address -->
                    <div class="input-group col-lg-12 mb-4">
                        <div class="input-group-prepend">
                            <span class="input-group-text bg-white px-4 border-md border-right-0">
                                <i class="fa fa-envelope text-muted"></i>
                            </span>
                        </div>
                        <input id="email" type="email" name="email" placeholder="Email Address" class="form-control bg-white border-left-0 border-md">
                    </div>

                    <!-- Phone Number -->
                    
                    <!-- Password -->
                    <div class="input-group col-lg-12 mb-4">
                        <div class="input-group-prepend">
                            <span class="input-group-text bg-white px-4 border-md border-right-0">
                                <i class="fa fa-lock text-muted"></i>
                            </span>
                        </div>
                        <input id="password" type="password" name="password" placeholder="Password" class="form-control bg-white border-left-0 border-md">
                    </div>

                                       

                    <!-- Submit Button -->
                    <div class="form-group col-lg-12 mx-auto mb-0">
                        <!-- <a href="index.html" class="btn btn-primary btn-block py-2"> -->
                            <input type="button" value='Login' onclick="login()" />
                        <!-- </a> -->
                    </div>
                    

                    <!-- Divider Text -->
                    <div class="form-group col-lg-12 mx-auto d-flex align-items-center my-4">
                        <div class="border-bottom w-100 ml-5"></div>
                        <span class="px-2 small text-muted font-weight-bold text-muted">OR</span>
                        <div class="border-bottom w-100 mr-5"></div>
                    </div>

                    <!-- Social Login -->
                    <div class="form-group col-lg-12 mx-auto">
                        <a href="#" class="btn btn-primary btn-block py-2 btn-facebook">
                            <i class="fa fa-facebook-f mr-2"></i>
                            <span class="font-weight-bold">Continue with Facebook</span>
                        </a>
                        <a href="#" class="btn btn-primary btn-block py-2 btn-twitter">
                            <i class="fa fa-twitter mr-2"></i>
                            <span class="font-weight-bold">Continue with Twitter</span>
                        </a>
                    </div>

                    <!-- Already Registered -->
                    <div class="text-center w-100">
                        <p class="text-muted font-weight-bold">Don't have an account yet? <a href="register.html" class="text-primary ml-2">Sign up</a></p>
                    </div>

                </div>
            </form>
        </div>
    </div>
</div>
</body>
<script>

// let serverUrl = 'https://tasklist-minh.herokuapp.com/';
//             var user = null;
//             var selectedTasklist;
//             var selectedTask;


//             const login = async () => {
//                 let email = document.getElementById('email').value;
//                 let password = document.getElementById('password').value;
//                 const response = await fetch(`${serverUrl}/auth/sign_in`,{
//                     method: 'POST',
//                     headers: {
//                         'Content-Type': 'application/json'
//                     },
//                     body: JSON.stringify({
//                         email,
//                         password
//                     })
//                 });
//                 if (response.ok){
//                     alert("Login successfully")
//                     window.location.assign("home.html")
//                 } else {
//                     alert("Wrong email or password. Please login again")
//                 }
//                 user = {
//                     'access-token': response.headers.get('access-token'),
//                     uid: response.headers.get('uid'),
//                     client: response.headers.get('client')
//                 };
//                 localStorage.setItem('user',JSON.stringify(user));
//                 document.getElementById('currentUser').innerHTML = user.uid;
//             }

            let serverUrl = 'https://tasklist-minh.herokuapp.com';
            var user = null;
            var selectedTasklist;
            var selectedTask;

       
            const login = async () => {
                let email = document.getElementById('email').value;
                let password = document.getElementById('password').value;
                const response = await fetch(`${serverUrl}/auth/sign_in`,{
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        email,
                        password
                    })
                });

                if (response.ok){
                    alert("Login successfully")
                    window.location.assign("home.html")
                } else {
                    alert("Wrong email or password. Please login again")
                }

                user = {
                    'access-token': response.headers.get('access-token'),
                    uid: response.headers.get('uid'),
                    client: response.headers.get('client')
                    };
                    localStorage.setItem('user',JSON.stringify(user)); 
                document.getElementById('currentUser').innerHTML = user.uid;
                }
           

// let serverUrl = 'https://tasklist-minh.herokuapp.com';
// var user = null;
// var selectedTasklist;
// var selectedTask;
// var selectedUser;

// const register = async () => {
//     let email = document.getElementById('registerEmail').value;
//     let password = document.getElementById('registerPassword').value;
//     const response = await fetch(`${serverUrl}/auth`,{
//         method: 'POST',
//         headers: {
//             'Content-Type': 'application/json'
//         },
//         body: JSON.stringify({
//             email,
//             password
//         })
//     });
//     if (response.ok)
//         alert("registered");                
// }

// const fetchUsers = async () => {
//     const fetchUserRequest = await fetch(`${serverUrl}/users`,{
//         method: 'GET',
//         headers: {
//             'Content-Type': 'application/json',
//             ...user
//         }
//     });
//     const users = await fetchUserRequest.json();
//     const form = document.getElementById('users');
//     form.innerHTML = '';
//     for (let u of users) {
//         let input = document.createElement("input");
//         input.name = 'selectedUser';
//         input.value = u.id;
//         input.id = `user_${u.id}`;
//         input.type = 'radio';
//         input.oninput = onSelectUser;
//         form.appendChild(input);
//         let span = document.createElement("span");
//         span.innerHTML = u.email;
//         form.appendChild(span);
//         form.appendChild(document.createElement('br'));
//     }
// }

// const saveLogin = async response => {
//     user = {
//         'access-token': response.headers.get('access-token'),
//         uid: response.headers.get('uid'),
//         client: response.headers.get('client')
//     };
//     localStorage.setItem('user',JSON.stringify(user));
//     const body = await response.json();
//     user.name = body.name;
//     await fetchUsers();
// }

// const login = async () => {
//     let email = document.getElementById('email').value;
//     let password = document.getElementById('password').value;
//     const response = await fetch(`${serverUrl}/auth/sign_in`,{
//         method: 'POST',
//         headers: {
//             'Content-Type': 'application/json'
//         },
//         body: JSON.stringify({
//             email,
//             password
//         })
//     });
    
//     await saveLogin(response);
// }
// const checkToken = async () => {
//     user = JSON.parse(await localStorage.getItem('user'));
//     try {
//         const response = await fetch(`${serverUrl}/profile`,{
//             method: 'GET',
//             headers: {
//                 'Content-Type': 'application/json',
//                 ...user
//             },
//         });
//         await saveLogin(response);
//         document.getElementById('currentUser').innerHTML = `${user.name ?? ''} ${user.uid}`;
//         return true;
//         alert("Login ok") 
//         window.location.assign("home.html");
//     } catch {
//         return false;
//         alert("Ooops ! login again"); 
//     }
// }
//     if (true){
//             alert("Login ok") 
//         window.location.assign("home.html");
        
//         }else {
//             alert("Ooops ! login again"); 
//         }
// }


//         let serverUrl = 'https://tasklist-minh.herokuapp.com';
//         var user = null;
//         var selectedTasklist;
//         var selectedTask;

//         const saveLogin = async response => {
//     user = {
//         'access-token': response.headers.get('access-token'),
//         uid: response.headers.get('uid'),
//         client: response.headers.get('client')
//     };
//     localStorage.setItem('user',JSON.stringify(user));
//     const body = await response.json();
//     user.name = body.name;
//     await fetchUsers();
// }

// const login = async () => {
//     let email = document.getElementById('email').value;
//     let password = document.getElementById('password').value;
//     const response = await fetch(`${serverUrl}/auth/sign_in`,{
//         method: 'POST',
//         headers: {
//             'Content-Type': 'application/json'
//         },
//         body: JSON.stringify({
//             email,
//             password
//         })
//     });
//     await saveLogin(response);


      

       
            // const login = async () => {
            //     let email = document.getElementById('email').value;
            //     let password = document.getElementById('password').value;
            //     const response = await fetch(`${serverUrl}/auth/sign_in`,{
            //         method: 'POST',
            //         headers: {
            //             'Content-Type': 'application/json'
            //         },
            //         body: JSON.stringify({
            //             email,
            //             password
            //         })
            //     });

            //     if (response.ok){
            //      alert("Login ok") 
            //     window.location.assign("home.html");
                
            //     }else {
            //         alert("Ooops ! login again"); 
            //     }

            //     user = {
            //         'access-token': response.headers.get('access-token'),
            //         uid: response.headers.get('uid'),
            //         client: response.headers.get('client')
            //         };
            //         localStorage.setItem('user',JSON.stringify(user)); 
            //     document.getElementById('currentUser').innerHTML = user.uid;
            //     }

                
</script>

